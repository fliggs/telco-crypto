enum SimType {
  P_SIM
  E_SIM
}

enum SimStatus {
  INITIAL
  RESERVED
  AVAILABLE
  ASSIGNED
}

model Sim {
  iccid     String    @id
  createdAt DateTime  @default(now())
  updatedAt DateTime  @default(now()) @updatedAt
  type      SimType
  status    SimStatus
  pin       String?
  puk       String?
  pin2      String?
  puk2      String?

  currentSubscription Subscription?

  assignments         SimAssignment[]
  telcoData           SimTelcoData[]
  subscriptionHistory SubscriptionHistory[]
}

model SimAssignment {
  id        String    @id @default(uuid()) @db.Uuid
  createdAt DateTime  @default(now())
  updatedAt DateTime  @default(now()) @updatedAt
  deletedAt DateTime?

  simIccid String
  sim      Sim    @relation(fields: [simIccid], references: [iccid])

  subscriptionId String       @db.Uuid
  subscription   Subscription @relation(fields: [subscriptionId], references: [id])

  @@index([subscriptionId])
  @@index([createdAt(sort: Desc)])
}
