enum PhoneNumberSource {
  GENERATED
  IMPORTED
}

enum PhoneNumberStatus {
  INITIAL
  RESERVED
  AVAILABLE
  ASSIGNED
}

model PhoneNumber {
  msisdn    String            @id
  createdAt DateTime          @default(now())
  updatedAt DateTime          @default(now()) @updatedAt
  source    PhoneNumberSource
  status    PhoneNumberStatus

  currentSubscription Subscription?

  assignments         PhoneNumberAssignment[]
  telcoData           PhoneNumberTelcoData[]
  subscriptionHistory SubscriptionHistory[]
}

model PhoneNumberAssignment {
  id        String    @id @default(uuid()) @db.Uuid
  createdAt DateTime  @default(now())
  updatedAt DateTime  @default(now()) @updatedAt
  deletedAt DateTime?

  phoneNumberMsisdn String
  phoneNumber       PhoneNumber @relation(fields: [phoneNumberMsisdn], references: [msisdn])

  subscriptionId String       @db.Uuid
  subscription   Subscription @relation(fields: [subscriptionId], references: [id])

  @@index([subscriptionId])
  @@index([createdAt(sort: Desc)])
}
